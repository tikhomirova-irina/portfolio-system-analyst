# üíæ SQL-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª —Å–æ–¥–µ—Ä–∂–∏—Ç **–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å SQL-–∑–∞–ø—Ä–æ—Å–æ–≤**, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏—Ö —Ä–∞–±–æ—Ç—É —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞.

–ó–∞–ø—Ä–æ—Å—ã —É–ø–æ—Ä—è–¥–æ—á–µ–Ω—ã **–æ—Ç –±–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∫ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–º –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º**, –≤–∫–ª—é—á–∞—è:
- –≤—ã–±–æ—Ä–∫—É –¥–∞–Ω–Ω—ã—Ö (`SELECT`)
- —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É (`WHERE`, `ORDER BY`)
- —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü (`JOIN`)
- –∞–≥—Ä–µ–≥–∞—Ü–∏—é (`COUNT`, `AVG`)
- –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã –∏ CTE
- –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

–ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç—Å—è **–±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–µ–π**, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å, –∫–∞–∫ SQL –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ.

---

## 1. –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Å–∏—Ö–æ—Ç–µ—Ä–∞–ø–µ–≤—Ç–æ–≤ —Å –∏—Ö –º–µ—Ç–æ–¥–æ–º —Ä–∞–±–æ—Ç—ã

**–ë–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∞:**  
–ö–ª–∏–µ–Ω—Ç –Ω–∞ —Å–∞–π—Ç–µ —Ö–æ—á–µ—Ç –≤—ã–±—Ä–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –ø–æ —Ç–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–æ–º—É –ø–æ–¥—Ö–æ–¥—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω–æ-–ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π, –≥–µ—à—Ç–∞–ª—å—Ç). –≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å –Ω—É–∂–µ–Ω –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Ç–µ—Ä–∞–ø–µ–≤—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ "–ü—Å–∏—Ö–æ—Ç–µ—Ä–∞–ø–µ–≤—Ç—ã".

```sql
SELECT 
    u.last_name, 
    u.first_name, 
    u.middle_name, 
    t.method
FROM therapist t
INNER JOIN "user" u ON t.user_id = u.user_id
ORDER BY t.method, u.last_name;
```

## 2. –í—Å–µ –∫–ª–∏–µ–Ω—Ç—ã —Å—Ç–∞—Ä—à–µ 25 –ª–µ—Ç

**–ë–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∞:**  
SMM-–º–µ–Ω–µ–¥–∂–µ—Ä –∏–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–ª–∞–Ω–∏—Ä—É–µ—Ç —Ü–µ–ª–µ–≤—É—é –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—É—é –∫–∞–º–ø–∞–Ω–∏—é –¥–ª—è –≤–∑—Ä–æ—Å–ª–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´—Ç–µ—Ä–∞–ø–∏—è –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π¬ª –∏–ª–∏ ¬´—Ä–∞–±–æ—Ç–∞ —Å–æ —Å—Ç—Ä–µ—Å—Å–æ–º —É –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–≤¬ª). –≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–¥–µ–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å—Ç–∞—Ä—à–µ 25 –ª–µ—Ç –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–∞—Å—Å—ã–ª–æ–∫.

```sql
SELECT 
    u.last_name, 
    u.first_name, 
    u.middle_name, 
    u.date_of_birth
FROM "user" u
WHERE u.role = 'client'
  AND EXTRACT(YEAR FROM AGE(CURRENT_DATE, u.date_of_birth)) > 25
ORDER BY u.last_name, u.first_name;
```

## 3. –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: –∫–ª–∏–µ–Ω—Ç, —Ç–µ—Ä–∞–ø–µ–≤—Ç, –≤—Ä–µ–º—è, —Ñ–æ—Ä–º–∞ —Ä–∞–±–æ—Ç—ã –∏ —Å—Ç–∞—Ç—É—Å

**–ë–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∞:**  
–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –Ω—É–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –ø–æ–ª—É—á–∏—Ç—å –æ–±–∑–æ—Ä –≤—Å–µ—Ö **–∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –±—É–¥—É—â–∏—Ö —Å–µ—Å—Å–∏–π** (–∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏ –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö) –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–µ 3 –º–µ—Å—è—Ü–∞. –≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ —Ü–µ–Ω—Ç—Ä–∞, –∫–æ–Ω—Ç—Ä–æ–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –æ—Ç—á—ë—Ç–æ–≤. –í—ã–≤–æ–¥ –≤–∫–ª—é—á–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, —á—Ç–æ–±—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–≥ —Ä–∞–∑–ª–∏—á–∞—Ç—å "–∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–æ" –∏ "–æ–ø–ª–∞—á–µ–Ω–æ".

```sql
SELECT 
    u.last_name AS client_last_name,
    u.first_name AS client_first_name,
    u.middle_name AS client_middle_name,
    u2.last_name AS therapist_last_name,
    u2.first_name AS therapist_first_name,
    u2.middle_name AS therapist_middle_name,
    s.start_time,
    st.name AS service_type,
    bs.status AS booking_status
FROM booking b
INNER JOIN "user" u ON b.client_user_id = u.user_id
INNER JOIN session s ON b.session_id = s.session_id
INNER JOIN "user" u2 ON s.therapist_user_id = u2.user_id
INNER JOIN service_type st ON s.service_type_id = st.service_type_id
INNER JOIN booking_status bs ON b.status_id = bs.status_id
WHERE bs.status IN ('booked', 'paid')
  AND s.start_time >= CURRENT_DATE
  AND s.start_time <= CURRENT_DATE + INTERVAL '3 months'
ORDER BY s.start_time, u2.last_name, u.last_name
LIMIT 1000;
```

## 4. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–µ–¥—ë–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–π –ø–æ –∫–∞–∂–¥–æ–º—É –ø—Å–∏—Ö–æ—Ç–µ—Ä–∞–ø–µ–≤—Ç—É –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≥–æ–¥

**–ë–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∞:**  
–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Ö–æ—á–µ—Ç –æ—Ü–µ–Ω–∏—Ç—å **–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø—Å–∏—Ö–æ—Ç–µ—Ä–∞–ø–µ–≤—Ç–æ–≤** –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≥–æ–¥. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –≤—ã—è–≤–∏—Ç—å —Å–∞–º—ã—Ö –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω—ã—Ö —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤,
- –æ—Ü–µ–Ω–∏—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å,
- –ø—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏—è –æ –º–æ—Ç–∏–≤–∞—Ü–∏–∏ –∏–ª–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏.

```sql
SELECT 
    u.last_name,
    u.first_name,
    u.middle_name,
    COUNT(b.booking_id) AS sessions_count
FROM booking b
INNER JOIN booking_status bs ON b.status_id = bs.status_id
INNER JOIN session s ON b.session_id = s.session_id
INNER JOIN "user" u ON s.therapist_user_id = u.user_id
WHERE bs.status = 'completed'
  AND s.start_time >= CURRENT_DATE - INTERVAL '1 year'
GROUP BY u.user_id, u.last_name, u.first_name, u.middle_name
ORDER BY sessions_count DESC;
```

## 5. –°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞ –∫–∞–∂–¥–æ–≥–æ –ø—Å–∏—Ö–æ—Ç–µ—Ä–∞–ø–µ–≤—Ç–∞ –ø–æ –æ—Ç–∑—ã–≤–∞–º (—Ç–æ–ª—å–∫–æ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≥–æ–¥, 3+ –æ—Ç–∑—ã–≤–æ–≤)

**–ë–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∞:**  
–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Ö–æ—á–µ—Ç –æ—Ü–µ–Ω–∏—Ç—å **–∞–∫—Ç—É–∞–ª—å–Ω—É—é —Ä–µ–ø—É—Ç–∞—Ü–∏—é —Ç–µ—Ä–∞–ø–µ–≤—Ç–æ–≤** ‚Äî –∫—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç –≤—ã—Å–æ–∫–∏–µ –æ—Ü–µ–Ω–∫–∏ **–≤ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è**. –≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å —É—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ—Ç–∑—ã–≤—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≥–æ–¥ –∏ –≤–∫–ª—é—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ—Ö —Ç–µ—Ä–∞–ø–µ–≤—Ç–æ–≤, —É –∫–æ–≥–æ 3 –∏ –±–æ–ª–µ–µ –æ—Ç–∑—ã–≤–æ–≤. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—è–≤–∏—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å–µ–π—á–∞—Å –æ—Å–æ–±–µ–Ω–Ω–æ –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω—ã –∏ –≤—ã—Å–æ–∫–æ –æ—Ü–µ–Ω–∏–≤–∞—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏.

```sql
SELECT 
    u.last_name,
    u.first_name,
    u.middle_name,
    ROUND(AVG(r.rating), 2) AS avg_rating,
    COUNT(r.review_id) AS review_count
FROM "user" u 
INNER JOIN review r ON r.therapist_user_id = u.user_id
WHERE r.rating IS NOT NULL
  AND r.created_at >= CURRENT_DATE - INTERVAL '1 year'
GROUP BY u.user_id, u.last_name, u.first_name, u.middle_name
HAVING COUNT(r.review_id) >= 3
ORDER BY avg_rating DESC, review_count DESC;
```
## 6. –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–Ω–æ–≤—ã–π, –∞–∫—Ç–∏–≤–Ω—ã–π, –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π)

**–ë–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∞:**  
–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Ö–æ—á–µ—Ç –ø–æ–Ω—è—Ç—å, –∫–∞–∫–∏–µ –∫–ª–∏–µ–Ω—Ç—ã —è–≤–ª—è—é—Ç—Å—è –Ω–æ–≤—ã–º–∏, –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∏–ª–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º–∏, —á—Ç–æ–±—ã:
- –º–æ—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å "—Å–ø—è—â–∏—Ö" –∫–ª–∏–µ–Ω—Ç–æ–≤ (—Ä–∞—Å—Å—ã–ª–∫–∞, —Å–∫–∏–¥–∫–∞),
- —É–¥–µ—Ä–∂–∞—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö,
- –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é –ø–æ–¥ —Å–µ–≥–º–µ–Ω—Ç.

–≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç CASE –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø—Ä–æ–≤–µ–¥—ë–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–π, —á—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —É–º–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ –≤ SQL.

```sql
SELECT 
    u.last_name,
    u.first_name,
    u.middle_name,
    COUNT(b.booking_id) AS total_sessions,
    CASE 
        WHEN COUNT(b.booking_id) = 1 THEN '–Ω–æ–≤—ã–π'
        WHEN COUNT(b.booking_id) BETWEEN 2 AND 4 THEN '–∞–∫—Ç–∏–≤–Ω—ã–π'
        WHEN COUNT(b.booking_id) >= 5 THEN '–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π'
        ELSE '–Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏'
    END AS client_segment
FROM "user" u
LEFT JOIN booking b ON u.user_id = b.client_user_id
WHERE u.role = 'client'
GROUP BY u.user_id, u.last_name, u.first_name, u.middle_name
ORDER BY total_sessions DESC;
```

## 7. –î–æ–ª—è –≤—ã—Ä—É—á–∫–∏ —Ç–µ—Ä–∞–ø–µ–≤—Ç–∞ –≤ —Ä–∞–º–∫–∞—Ö –µ–≥–æ —Ñ–æ—Ä–º—ã —Ä–∞–±–æ—Ç—ã (–ø—Ä–æ–≤–µ–¥—ë–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏, –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞)

**–ë–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∞:**  
–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Ö–æ—á–µ—Ç –æ—Ü–µ–Ω–∏—Ç—å –≤–∫–ª–∞–¥ –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Ä–∞–ø–µ–≤—Ç–∞ –≤ –¥–æ—Ö–æ–¥ —Å–≤–æ–µ–π –Ω–∏—à–∏ (–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è, —Å–µ–º–µ–π–Ω–∞—è, –≥—Ä—É–ø–ø–æ–≤–∞—è —Ñ–æ—Ä–º–∞ —Ä–∞–±–æ—Ç—ã). –≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –¥–æ–ª—é –≤—ã—Ä—É—á–∫–∏ —Ç–µ—Ä–∞–ø–µ–≤—Ç–∞ –æ—Ç –æ–±—â–µ–≥–æ –¥–æ—Ö–æ–¥–∞ –ø–æ —Ñ–æ—Ä–º–µ, —á—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç:
- –≤—ã—è–≤–∏—Ç—å –∫–ª—é—á–µ–≤—ã—Ö —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤,
- –æ—Ü–µ–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å –Ω–∞–≥—Ä—É–∑–∫–∏,
- –ø—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏—è –ø–æ –º–æ—Ç–∏–≤–∞—Ü–∏–∏ –∏ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É.

```sql
SELECT 
    u.last_name,
    u.first_name,
    st.name AS service_type,
    COUNT(b.booking_id) AS completed_sessions_count,
    SUM(p.amount) AS total_revenue,
    ROUND(
        100.0 * SUM(p.amount) / SUM(SUM(p.amount)) OVER (PARTITION BY st.service_type_id),
        2
    ) AS share_revenue_percent
FROM booking b
INNER JOIN booking_status bs ON b.status_id = bs.status_id
INNER JOIN session s ON b.session_id = s.session_id
INNER JOIN payment p ON b.booking_id = p.booking_id
INNER JOIN "user" u ON s.therapist_user_id = u.user_id
INNER JOIN service_type st ON s.service_type_id = st.service_type_id
WHERE bs.status = 'completed'
  AND s.start_time >= CURRENT_DATE - INTERVAL '3 months'
GROUP BY u.user_id, u.last_name, u.first_name, st.service_type_id, st.name
ORDER BY st.name, share_revenue_percent DESC;
```

## 8. –î–∏–Ω–∞–º–∏–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ—Ç–∑—ã–≤–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º (–∑–∞ 6 –ø–æ–ª–Ω—ã—Ö –º–µ—Å—è—Ü–µ–≤)

**–ë–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∞:**  
–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Ö–æ—á–µ—Ç –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏–∫—É –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ —Ç–µ—Ä–∞–ø–µ–≤—Ç–æ–≤ –∑–∞ **–ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –ø–æ–ª–Ω—ã—Ö –º–µ—Å—è—Ü–µ–≤**, –∏—Å–∫–ª—é—á–∞—è —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∏—Å–∫–∞–∂–µ–Ω–∏–π –∏–∑-–∑–∞ –Ω–µ–ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—è–≤–∏—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤, —á—å—è –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å —Ä–∞—Å—Ç—ë—Ç, –∏ –ø—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏—è –ø–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É –∏ –º–æ—Ç–∏–≤–∞—Ü–∏–∏.

```sql
WITH review_month AS (
    SELECT 
        r.therapist_user_id,
        DATE_TRUNC('month', r.created_at)::DATE AS review_month,
        COUNT(r.review_id) AS review_count
    FROM review r
    WHERE r.created_at >= DATE_TRUNC('month', CURRENT_DATE - INTERVAL '6 months')
      AND r.created_at < DATE_TRUNC('month', CURRENT_DATE)
    GROUP BY r.therapist_user_id, DATE_TRUNC('month', r.created_at)
),
review_month_growth AS (
    SELECT 
        rm.therapist_user_id,
        rm.review_month,
        rm.review_count,
        LAG(rm.review_count) OVER (
            PARTITION BY rm.therapist_user_id 
            ORDER BY rm.review_month
        ) AS review_count_prev
    FROM review_month rm
)
SELECT 
    u.last_name,
    u.first_name,
    u.middle_name,
    rmg.review_month,
    rmg.review_count,
    rmg.review_count_prev,
    rmg.review_count - COALESCE(rmg.review_count_prev, 0) AS review_growth
FROM review_month_growth rmg
INNER JOIN "user" u ON rmg.therapist_user_id = u.user_id
ORDER BY 
    review_growth DESC
    rmg.review_month DESC;
```
## 9. –¢–µ—Ä–∞–ø–µ–≤—Ç—ã, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ –æ—Ç–∑—ã–≤–∞

**–ë–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∞:**  
–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Ö–æ—á–µ—Ç –≤—ã—è–≤–∏—Ç—å —Ç–µ—Ä–∞–ø–µ–≤—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç, –Ω–æ –Ω–µ –ø–æ–ª—É—á–∞—é—Ç –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã —Å–±–æ—Ä–∞ —Ñ–∏–¥–±–µ–∫–∞.

```sql
SELECT 
    u.last_name,
    u.first_name,
    u.middle_name
FROM "user" u
INNER JOIN therapist t ON u.user_id = t.user_id
LEFT JOIN review r ON t.user_id = r.therapist_user_id
WHERE r.review_id IS NULL
ORDER BY u.last_name, u.first_name;
