# ðŸ’¾ SQL-Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð´Ð»Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…

Ð­Ñ‚Ð¾Ñ‚ Ñ€Ð°Ð·Ð´ÐµÐ» ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ **Ð¾Ð±ÑƒÑ‡Ð°ÑŽÑ‰ÑƒÑŽ Ð¿Ð¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ SQL-Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð²**, Ð´ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð¸Ñ€ÑƒÑŽÑ‰Ð¸Ñ… Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ Ñ Ð±Ð°Ð·Ð¾Ð¹ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¿ÑÐ¸Ñ…Ð¾Ð»Ð¾Ð³Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ñ†ÐµÐ½Ñ‚Ñ€Ð°.

Ð—Ð°Ð¿Ñ€Ð¾ÑÑ‹ ÑƒÐ¿Ð¾Ñ€ÑÐ´Ð¾Ñ‡ÐµÐ½Ñ‹ **Ð¾Ñ‚ Ð±Ð°Ð·Ð¾Ð²Ñ‹Ñ… Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹ Ðº Ð±Ð¾Ð»ÐµÐµ ÑÐ»Ð¾Ð¶Ð½Ñ‹Ð¼ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼ ÐºÐ¾Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸ÑÐ¼**, Ð²ÐºÐ»ÑŽÑ‡Ð°Ñ:
- Ð²Ñ‹Ð±Ð¾Ñ€ÐºÑƒ Ð´Ð°Ð½Ð½Ñ‹Ñ… (`SELECT`)
- Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸ÑŽ Ð¸ ÑÐ¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÑƒ (`WHERE`, `ORDER BY`)
- ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ðµ Ñ‚Ð°Ð±Ð»Ð¸Ñ† (`JOIN`)
- Ð°Ð³Ñ€ÐµÐ³Ð°Ñ†Ð¸ÑŽ (`COUNT`, `AVG`)
- Ð¿Ð¾Ð´Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð¸ CTE

ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ð·Ð°Ð¿Ñ€Ð¾Ñ ÑÐ¾Ð¿Ñ€Ð¾Ð²Ð¾Ð¶Ð´Ð°ÐµÑ‚ÑÑ **Ð±Ð¸Ð·Ð½ÐµÑ-Ð·Ð°Ð´Ð°Ñ‡ÐµÐ¹**, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ð¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ, ÐºÐ°Ðº SQL Ð¿Ð¾Ð¼Ð¾Ð³Ð°ÐµÑ‚ Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°Ñ‚ÑŒ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¹ ÑÐ¸ÑÑ‚ÐµÐ¼Ðµ.

---

## 1. Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð²ÑÐµÑ… Ð¿ÑÐ¸Ñ…Ð¾Ñ‚ÐµÑ€Ð°Ð¿ÐµÐ²Ñ‚Ð¾Ð² Ñ Ð¸Ñ… Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð¼ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹

**Ð‘Ð¸Ð·Ð½ÐµÑ-Ð·Ð°Ð´Ð°Ñ‡Ð°:**  
ÐšÐ»Ð¸ÐµÐ½Ñ‚ Ð½Ð° ÑÐ°Ð¹Ñ‚Ðµ Ñ…Ð¾Ñ‡ÐµÑ‚ Ð²Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚Ð° Ð¿Ð¾ Ñ‚ÐµÑ€Ð°Ð¿ÐµÐ²Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¼Ñƒ Ð¿Ð¾Ð´Ñ…Ð¾Ð´Ñƒ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, ÐºÐ¾Ð³Ð½Ð¸Ñ‚Ð¸Ð²Ð½Ð¾-Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ñ‡ÐµÑÐºÐ¸Ð¹, Ð³ÐµÑˆÑ‚Ð°Ð»ÑŒÑ‚). Ð­Ñ‚Ð¾Ñ‚ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð½ÑƒÐ¶ÐµÐ½ Ð´Ð»Ñ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ ÑÐ¿Ð¸ÑÐºÐ° Ñ‚ÐµÑ€Ð°Ð¿ÐµÐ²Ñ‚Ð¾Ð² Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ "ÐŸÑÐ¸Ñ…Ð¾Ñ‚ÐµÑ€Ð°Ð¿ÐµÐ²Ñ‚Ñ‹".

```sql
SELECT 
    u.last_name, 
    u.first_name, 
    u.middle_name, 
    t.method
FROM therapist t
INNER JOIN "user" u ON t.user_id = u.id
ORDER BY t.method, u.last_name;
```

## 2. Ð’ÑÐµ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ñ‹ ÑÑ‚Ð°Ñ€ÑˆÐµ 25 Ð»ÐµÑ‚

**Ð‘Ð¸Ð·Ð½ÐµÑ-Ð·Ð°Ð´Ð°Ñ‡Ð°:**  
SMM-Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€ Ð¸Ð»Ð¸ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€ Ð¿Ð»Ð°Ð½Ð¸Ñ€ÑƒÐµÑ‚ Ñ†ÐµÐ»ÐµÐ²ÑƒÑŽ Ð¼Ð°Ñ€ÐºÐµÑ‚Ð¸Ð½Ð³Ð¾Ð²ÑƒÑŽ ÐºÐ°Ð¼Ð¿Ð°Ð½Ð¸ÑŽ Ð´Ð»Ñ Ð²Ð·Ñ€Ð¾ÑÐ»Ð¾Ð¹ Ð°ÑƒÐ´Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¸ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Â«Ñ‚ÐµÑ€Ð°Ð¿Ð¸Ñ Ð´Ð»Ñ Ñ€Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÐµÐ¹Â» Ð¸Ð»Ð¸ Â«Ñ€Ð°Ð±Ð¾Ñ‚Ð° ÑÐ¾ ÑÑ‚Ñ€ÐµÑÑÐ¾Ð¼ Ñƒ Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»Ð¾Ð²Â»). Ð­Ñ‚Ð¾Ñ‚ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð²Ñ‹Ð´ÐµÐ»Ð¸Ñ‚ÑŒ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð² ÑÑ‚Ð°Ñ€ÑˆÐµ 25 Ð»ÐµÑ‚ Ð´Ð»Ñ ÑÐµÐ³Ð¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸ Ð¸ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… Ñ€Ð°ÑÑÑ‹Ð»Ð¾Ðº.

```sql
SELECT 
    u.last_name, 
    u.first_name, 
    u.middle_name, 
    u.date_of_birth
FROM "user" u
WHERE u.role = 'client'
  AND EXTRACT(YEAR FROM AGE(CURRENT_DATE, u.date_of_birth)) > 25
ORDER BY u.last_name, u.first_name;
```

## 3. ÐÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ: ÐºÐ»Ð¸ÐµÐ½Ñ‚, Ñ‚ÐµÑ€Ð°Ð¿ÐµÐ²Ñ‚, Ð²Ñ€ÐµÐ¼Ñ, Ñ„Ð¾Ñ€Ð¼Ð° Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð¸ ÑÑ‚Ð°Ñ‚ÑƒÑ

**Ð‘Ð¸Ð·Ð½ÐµÑ-Ð·Ð°Ð´Ð°Ñ‡Ð°:**  
ÐÐ´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ñƒ Ð½ÑƒÐ¶Ð½Ð¾ Ð±Ñ‹ÑÑ‚Ñ€Ð¾ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¾Ð±Ð·Ð¾Ñ€ Ð²ÑÐµÑ… **Ð°ÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð±ÑƒÐ´ÑƒÑ‰Ð¸Ñ… ÑÐµÑÑÐ¸Ð¹** (Ð·Ð°Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… Ð¸ Ð¾Ð¿Ð»Ð°Ñ‡ÐµÐ½Ð½Ñ‹Ñ…) Ð½Ð° Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐ¸Ðµ 3 Ð¼ÐµÑÑÑ†Ð°. Ð­Ñ‚Ð¾Ñ‚ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸ Ñ†ÐµÐ½Ñ‚Ñ€Ð°, ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ñ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ñ Ð¸ Ð¿Ð¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ¸ Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ð¾Ð². Ð’Ñ‹Ð²Ð¾Ð´ Ð²ÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚ ÑÑ‚Ð°Ñ‚ÑƒÑ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€ Ð¼Ð¾Ð³ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð°Ñ‚ÑŒ "Ð·Ð°Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾" Ð¸ "Ð¾Ð¿Ð»Ð°Ñ‡ÐµÐ½Ð¾".

```sql
SELECT 
    u.last_name AS client_last_name,
    u.first_name AS client_first_name,
    u.middle_name AS client_middle_name,
    u2.last_name AS therapist_last_name,
    u2.first_name AS therapist_first_name,
    u2.middle_name AS therapist_middle_name,
    s.start_time,
    st.name AS service_type,
    bs.status AS booking_status
FROM booking b
INNER JOIN "user" u ON b.client_user_id = u.id
INNER JOIN session s ON b.session_id = s.session_id
INNER JOIN "user" u2 ON s.therapist_user_id = u2.id
INNER JOIN service_type st ON s.service_type_id = st.service_type_id
INNER JOIN booking_status bs ON b.status_id = bs.status_id
WHERE bs.status IN ('booked', 'paid')
  AND s.start_time >= CURRENT_DATE
  AND s.start_time <= CURRENT_DATE + INTERVAL '3 months'
ORDER BY s.start_time ASC, u2.last_name, u.last_name
LIMIT 1000;
