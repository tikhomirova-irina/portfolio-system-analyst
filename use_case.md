# Use Case Specifications  
**Проект:** Разработка веб-приложения для записи клиентов в психологический центр  
**Автор:** И.И. Тихомирова  
**Дата:** 12.09.2025  

---

## 1. Забронировать сессию (Клиент)

| Поле | Описание |
|------|----------|
| **Название Use Case** | Забронировать сессию |
| **Актор** | Клиент |
| **Цель** | Клиент хочет выбрать психотерапевта, форму работы и доступное время, чтобы забронировать сессию и перейти к оплате. |
| **Предварительные условия** | - Клиент авторизован в системе (Авт_1, Бр_5)<br>- Психотерапевт имеет актуальное расписание (Рас_1, Рас_6)<br>- Форма работы и цена для выбранного психотерапевта корректно настроены (Бр_8) |
| **Основной сценарий** | 1. Клиент переходит на страницу «Психотерапевты» (Пр_1).<br>2. Выбирает психотерапевта → система отображает его расписание и цены (Пр_8, Бр_1, Бр_8).<br>3. Выбирает форму работы (индивидуальная/семейная/групповая) → стоимость автоматически обновляется (Бр_2, Бр_8).<br>4. Система показывает доступные временные слоты (Рас_6, Бр_3).<br>5. Клиент выбирает время и нажимает «Забронировать».<br>6. Система создает запись со статусом «Забронировано» (Бр_10).<br>7. Система отправляет SMS клиенту и психотерапевту с подтверждением брони (Со_1).<br>8. Система отправляет email с ссылкой на оплату (Со_10).<br>9. Система перенаправляет клиента на страницу оплаты (Бр_9). |
| **Альтернативные сценарии** | **A1. Клиент не авторизован**<br>- При нажатии «Забронировать» система перенаправляет на форму авторизации (Бр_5). После успешной авторизации — возвращает на форму бронирования.<br><br>**A2. Нет подходящего времени**<br>- Клиент выбирает «Записаться в лист ожидания» → система сохраняет данные в таблицу `Лист ожидания` (Бр_4, Пр_11).<br>- Отображается сообщение: *«Ваш запрос принят. Мы свяжемся при появлении свободного времени»*. |
| **Исключительные сценарии** | **E1. Ошибка отправки SMS**<br>- Система фиксирует ошибку в логах (Мо_3), отправляет уведомление администратору.<br>- Клиенту показывается: *«Сообщение не отправлено. Проверьте почту»*.<br><br>**E2. Система недоступна при бронировании**<br>- Возвращается ошибка 500 → пользователю показывается: *«Сервис временно недоступен. Попробуйте позже»*. |
| **Постусловия** | - Создана запись в таблице `Запись` со статусом «Забронировано» (Таблица 16)<br>- Уведомления отправлены (SMS + Email)<br>- Сессия отображается в списке текущих записей клиента |
| **Требования, которые покрываются** | Бр_1, Бр_2, Бр_3, Бр_4, Бр_5, Бр_8, Бр_9, Бр_10, Со_1, Со_10, Пр_1, Пр_8, Пр_14 |
| **Бизнес-правила** | - Цена рассчитывается по комбинации психотерапевт + форма работы (Таблица 3).<br>- Время бронирования возможно только в рамках расписания психотерапевта (Рас_5). |

---

## 2. Оплатить сессию (Клиент)

| Поле | Описание |
|------|----------|
| **Название Use Case** | Оплатить сессию |
| **Актор** | Клиент |
| **Цель** | Клиент хочет завершить бронирование, оплатив сессию онлайн, чтобы получить доступ к сессионному залу. |
| **Предварительные условия** | - Сессия забронирована, но не оплачена (статус «Забронировано»)<br>- Данные о психотерапевте, форме работы и цене корректны (Оу_2) |
| **Основной сценарий** | 1. Клиент переходит на страницу оплаты (после бронирования или по ссылке из email).<br>2. Система отображает: психотерапевта, время, форму работы, стоимость (Оу_2).<br>3. Клиент выбирает способ оплаты: банковская карта / СБП / мобильное приложение (Оу_3).<br>4. Система инициирует платеж через ЮKassa (Пс_1, Оу_4).<br>5. Платежный сервис возвращает статус «Успешно» (Пс_2).<br>6. Система обновляет статус сессии на «Оплачено» (Бр_10).<br>7. Система отправляет клиенту SMS и email с ссылкой на Google Meet (Оу_6, Со_11).<br>8. Клиенту показывается сообщение: *«Оплата прошла успешно! Ссылка на сессию отправлена на почту»* (Оу_5). |
| **Альтернативные сценарии** | **A1. Оплата частично прошла**<br>- Система получает статус «Частичная оплата» → сохраняет как «Неоплачено», отправляет уведомление клиенту и администратору (Оу_9, Со_9). |
| **Исключительные сценарии** | **E1. Ошибка платежного сервиса**<br>- Система получает статус «Ошибка» или «Отклонено» → показывает: *«Оплата не удалась. Попробуйте другую карту или свяжитесь с администратором»* (Оу_9).<br>- Администратор получает email-уведомление (Оу_10, Со_9).<br><br>**E2. Платеж прерван**<br>- Клиент закрывает окно до завершения → статус остается «Забронировано». Через час система отправляет напоминание об оплате (Со_12). |
| **Постусловия** | - Статус сессии обновлен на «Оплачено»<br>- Создана запись в таблице `Оплата` (Оу_7)<br>- Ссылка на Google Meet активна и отправлена |
| **Требования, которые покрываются** | Оу_2, Оу_3, Оу_4, Оу_5, Оу_6, Оу_7, Оу_9, Оу_10, Пс_1, Пс_2, Со_9, Со_11, Бр_10 |
| **Бизнес-правила** | - Оплата обязательна до начала сессии. Без оплаты доступ к залу не выдается.<br>- Данные карт не хранятся — используется токенизация ЮKassa (Нф_2). |

---

## 3. Перенести сессию (Клиент)

| Поле | Описание |
|------|----------|
| **Название Use Case** | Перенести сессию |
| **Актор** | Клиент |
| **Цель** | Клиент хочет изменить дату и/или время своей сессии, сохранив статус оплаты. |
| **Предварительные условия** | - Сессия существует и имеет статус «Забронировано» или «Оплачено» (Бр_10)<br>- Клиент авторизован |
| **Основной сценарий** | 1. Клиент заходит в «Личный кабинет» → «Текущие записи» (Пр_14).<br>2. Выбирает сессию → нажимает «Перенести» (Бр_6).<br>3. Система открывает форму аналогичную бронированию, но с предвыбором текущего психотерапевта и формы работы.<br>4. Клиент выбирает новое время (доступные слоты — только для этого психотерапевта и формы) (Бр_3, Рас_6).<br>5. Нажимает «Подтвердить».<br>6. Система обновляет запись в таблице `Сессия` и `Запись`.<br>7. Система сохраняет старый статус (если была оплачена — остаётся «Оплачено») (Бр_10).<br>8. Отправляются SMS клиенту и психотерапевту с новым временем (Со_2).<br>9. Показывается сообщение: *«Сессия перенесена. Новое время: [дата/время]»*. |
| **Альтернативные сценарии** | **A1. Нет доступных слотов**<br>- Система предлагает: *«На выбранный период нет свободных мест. Хотите записаться в лист ожидания?»* → направляет на форму листа ожидания (Бр_4). |
| **Исключительные сценарии** | **E1. Сессия оплачена, перенос менее чем за 24 часа**<br>- Система проверяет срок (Бр_11): если < 24 ч — блокирует перенос без доплаты.<br>- Показывает: *«Для переноса менее чем за сутки требуется доплата 50%. Свяжитесь с администратором»* (Бр_11). |
| **Постусловия** | - Обновлены дата/время в таблицах `Сессия` и `Запись`<br>- Уведомления отправлены<br>- Статус оплаты сохранён |
| **Требования, которые покрываются** | Бр_6, Бр_10, Бр_11, Со_2, Рас_6, Пр_15 |
| **Бизнес-правила** | - Перенос возможен только до момента начала сессии.<br>- Если сессия оплачена, и перенос происходит менее чем за 24 часа — требуется согласование администратора (Бр_11). |

---

## 4. Внести запись о сессии (Психотерапевт)

| Поле | Описание |
|------|----------|
| **Название Use Case** | Внести запись о сессии |
| **Актор** | Психотерапевт |
| **Цель** | Психотерапевт хочет зафиксировать детали проведённой сессии для ведения истории клиента и последующей супервизии. |
| **Предварительные условия** | - Психотерапевт авторизован (Авт_1)<br>- Сессия уже проведена (статус «Проведена»)<br>- Клиент связан с этой сессией |
| **Основной сценарий** | 1. Психотерапевт заходит в «Личный кабинет» → «Журнал клиентов» (Пр_21).<br>2. Нажимает «Внести запись о сессии» (Жк_1).<br>3. Система автоматически подставляет: имя клиента, дату сессии (из таблицы `Сессия`).<br>4. Психотерапевт заполняет поля:<br>   - Запрос клиента<br>   - Процесс сессии<br>   - Домашнее задание<br>   - Успехи<br>   - Неудачи<br>   - Планы на следующую сессию<br>5. Нажимает «Сохранить».<br>6. Система сохраняет запись в таблицу `Журнал сессий` (Жк_1).<br>7. Показывает сообщение: *«Запись успешно сохранена»*. |
| **Альтернативные сценарии** | **A1. Клиент не найден в списке**<br>- Система предлагает выбрать клиента из списка всех своих пациентов (по связи с `Запись`). |
| **Исключительные сценарии** | **E1. Психотерапевт пытается редактировать чужую запись**<br>- Система блокирует доступ, показывает: *«Доступ запрещён. Эта запись принадлежит другому специалисту»* (Нф_1). |
| **Постусловия** | - Создана запись в таблице `Журнал сессий`<br>- Данные доступны только психотерапевту и администратору (Нф_1) |
| **Требования, которые покрываются** | Жк_1, Жк_3, Нф_1, Пр_13 |
| **Бизнес-правила** | - Все записи конфиденциальны и доступны только владельцу сессии (Нф_1).<br>- Поля «Домашнее задание», «Планы» — обязательны для заполнения при первой сессии. |

---

## 5. Оставить отзыв (Клиент)

| Поле | Описание |
|------|----------|
| **Название Use Case** | Оставить отзыв |
| **Актор** | Клиент |
| **Цель** | Клиент хочет выразить удовлетворённость услугой и помочь центру улучшить качество работы. |
| **Предварительные условия** | - Клиент прошёл хотя бы одну сессию (статус «Проведена»)<br>- Клиент авторизован |
| **Основной сценарий** | 1. Клиент переходит в «Личный кабинет» → «Оставить отзыв» (Пр_14).<br>2. Система отображает форму с полями:<br>   - Имя психотерапевта (выпадающий список — только те, с кем был контакт)<br>   - Оценка (1–5 звёзд)<br>   - Отзыв (текстовое поле)<br>3. Клиент выбирает психотерапевта (опционально), ставит оценку (кликом по звёздам) (Ос_1, Ос_2).<br>4. Вводит текст отзыва (обязательно).<br>5. Нажимает «Отправить».<br>6. Система сохраняет отзыв в таблицу `Отзыв` (Ос_1).<br>7. Отправляет подтверждение: *«Спасибо за отзыв! Он поможет нам стать лучше»* (Ос_6). |
| **Альтернативные сценарии** | **A1. Клиент не проходил сессии**<br>- Система скрывает форму и показывает: *«Вы ещё не прошли ни одной сессии. Оставить отзыв можно после первого приёма»*. |
| **Исключительные сценарии** | **E1. Отзыв содержит угрозы/непристойности**<br>- Система фиксирует событие в логах, отправляет уведомление администратору.<br>- Отзыв сохраняется как «На модерации» (Ос_5). |
| **Постусловия** | - Создан отзыв в таблице `Отзыв`<br>- Психотерапевт и администратор могут видеть отзыв (Ос_3, Ос_4) |
| **Требования, которые покрываются** | Ос_1, Ос_2, Ос_3, Ос_4, Ос_6, Пр_8, Пр_10 |
| **Бизнес-правила** | - Отзывы анонимны по умолчанию (ФИО клиента — опционально).<br>- Оценка сохраняется как число от 1 до 5 (Ос_2). |

---

## 6. Назначить цену на сессию (Психотерапевт)

| Поле | Описание |
|------|----------|
| **Название Use Case** | Назначить цену на сессию |
| **Актор** | Психотерапевт |
| **Цель** | Психотерапевт хочет установить собственную стоимость услуг для разных форм работы, исходя из опыта и рынка. |
| **Предварительные условия** | - Психотерапевт авторизован (Авт_1)<br>- Психотерапевт имеет роль «Психотерапевт» (Список ролей) |
| **Основной сценарий** | 1. Психотерапевт заходит в «Личный кабинет» → «Назначение цен на сессии» (Пр_21).<br>2. Система отображает таблицу с тремя строками: Индивидуальная, Семейная, Групповая (Таблица 26).<br>3. Психотерапевт вводит цену в каждое поле (Оу_11).<br>4. Нажимает «Сохранить».<br>5. Система проверяет: цена ≥ 0 и ≤ 10000 руб. (бизнес-ограничение).<br>6. Сохраняет значения в таблицу `Цена` (ID_учетная запись психотерапевта + ID_форма работы).<br>7. Отображает сообщение: *«Цены обновлены. Они будут применяться при бронировании»*. |
| **Альтернативные сценарии** | **A1. Психотерапевт вводит отрицательную цену**<br>- Система подсвечивает поле красным: *«Цена не может быть меньше 0»*. |
| **Исключительные сценарии** | **E1. Психотерапевт пытается изменить цену, когда есть активные брони**<br>- Система блокирует сохранение и выводит: *«Есть активные бронирования. Изменение цен возможно только для будущих сессий. Для текущих — сохраняются старые цены»*. |
| **Постусловия** | - Цены обновлены в таблице `Цена`<br>- Новые цены применяются при бронировании новых сессий |
| **Требования, которые покрываются** | Оу_11, Бр_8, Пр_26 |
| **Бизнес-правила** | - Цены устанавливаются индивидуально каждым психотерапевтом.<br>- Изменение цен не влияет на уже забронированные и оплаченные сессии. |

---

## 7. Управление пользователями (Администратор)

| Поле | Описание |
|------|----------|
| **Название Use Case** | Управление пользователями |
| **Актор** | Администратор |
| **Цель** | Администратор хочет добавлять, редактировать или удалять пользователей (психотерапевтов, SMM, других админов) для корректного управления доступом. |
| **Предварительные условия** | - Администратор авторизован (Авт_1)<br>- Роль администратора подтверждена (Список ролей) |
| **Основной сценарий** | 1. Администратор заходит в «Личный кабинет» → «Администрирование пользователей» (Пр_33).<br>2. Видит таблицу со всеми пользователями (ФИО, email, роль, телефон).<br>3. Нажимает «Добавить пользователя».<br>4. Заполняет форму: ФИО, email, телефон, роль (клиент/психотерапевт/админ/SMM) (Адм_1, Пр_34).<br>5. Система проверяет уникальность email (Авт_4).<br>6. Сохраняет учётную запись (Таблица 7).<br>7. Автоматически отправляет email с паролем и ссылкой на регистрацию (Со_5).<br>8. Показывает: *«Пользователь добавлен. Уведомление отправлено»*. |
| **Альтернативные сценарии** | **A1. Редактирование существующего пользователя**<br>- Администратор нажимает «Редактировать» → меняет роль/телефон/ФИО → сохраняет (Адм_2).<br>- Email не редактируется. |
| **Исключительные сценарии** | **E1. Удаление пользователя с активными сессиями**<br>- Система блокирует удаление и показывает: *«Пользователь имеет активные записи. Сначала переведите их на другого специалиста или отмените сессии»* (Адм_3). |
| **Постусловия** | - Учётная запись создана/изменена/удалена в таблице `Учетная запись`<br>- Связанные роли обновлены в таблице `Список ролей` |
| **Требования, которые покрываются** | Адм_1, Адм_2, Адм_3, Со_5, Пр_14, Пр_34 |
| **Бизнес-правила** | - Только администратор может назначать роли «психотерапевт» и «SMM».<br>- Удаление пользователя не удаляет исторические данные (отзывы, сессии, оплаты). |

---
